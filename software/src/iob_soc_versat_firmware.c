#include "bsp.h"
#include "iob-timer.h"
#include "iob-uart.h"
#include "iob_soc_versat_conf.h"
#include "iob_soc_versat_periphs.h"
#include "iob_soc_versat_system.h"
#include "printf.h"
#include <string.h>

// MARKED
// McEliece
#include "api.h"
//#include "nistkatrng.h"

void nist_kat_init(unsigned char *entropy_input, unsigned char *personalization_string, int security_strength);

#ifdef __cplusplus
extern "C"{
#endif
void InitMcEliece(int versatBase); // MARKED

int RunTest(int versatBase);
#ifdef __cplusplus
}
#endif

#if 1

// MARKED
static char HexToInt(char ch){
   if('0' <= ch && ch <= '9'){
      return (ch - '0');
   } else if('a' <= ch && ch <= 'f'){
      return ch - 'a' + 10;
   } else if('A' <= ch && ch <= 'F'){
      return ch - 'A' + 10;
   } else {
      printf("Error, invalid character inside hex string:%c",ch);
      return 0;
   }
}

// Make sure that buffer is capable of storing the whole thing. Returns number of bytes inserted
int HexStringToHex(char* buffer,const char* str){
   int inserted = 0;
   for(int i = 0; ; i += 2){
      char upper = str[i];
      char lower = str[i+1];

      if(upper == '\0' || lower == '\0'){
         if(upper != '\0') printf("Warning: HexString was not divisible by 2\n");
         break;
      }   

      buffer[inserted++] = HexToInt(upper) * 16 + HexToInt(lower);
   }

   return inserted;
}

char GetHexadecimalChar(unsigned char value){
  if(value < 10){
    return '0' + value;
  } else{
    return 'A' + (value - 10);
  }
}

char* GetHexadecimal(const char* text,char* buffer,int byte_size){
  int i = 0;
  unsigned char* view = (unsigned char*) text;
  for(; i< byte_size; i++){
    buffer[i*2] = GetHexadecimalChar(view[i] / 16);
    buffer[i*2+1] = GetHexadecimalChar(view[i] % 16);
  }

  buffer[i*2] = '\0';

  return buffer;
}

#endif

int main(int argc,char* argv[]){
   char pass_string[] = "Test passed!";
   char fail_string[] = "Test failed!";

   // init timer
   timer_init(TIMER0_BASE);

   // init uart
   uart_init(UART0_BASE, FREQ / BAUD);
   printf_init(&uart_putc);

   uart_puts("\n\n\nGonna run test\n\n\n");
   
   //int result = RunTest(VERSAT0_BASE);

   // McEliece
   {
    //InitMcEliece(VERSAT0_BASE);

    unsigned char public_key[PQCLEAN_MCELIECE348864_CLEAN_CRYPTO_PUBLICKEYBYTES];
    unsigned char secret_key[PQCLEAN_MCELIECE348864_CLEAN_CRYPTO_SECRETKEYBYTES];

    unsigned char seed[48];

    HexStringToHex(seed,"061550234D158C5EC95595FE04EF7A25767F2E24CC2BC479D09D86DC9ABCFDE7056A8C266F9EF97ED08541DBD2E1FFA1");

    //InitArena(4*1024*1024); // 4 megabytes should suffice

    nist_kat_init(seed, NULL, 256);

    //nist_kat_init(entropy_input, NULL, 256);
        
    // McEliece Key Pair
    PQCLEAN_MCELIECE348864_CLEAN_crypto_kem_keypair(public_key, secret_key);

    unsigned char public_key_buffer[PQCLEAN_MCELIECE348864_CLEAN_CRYPTO_PUBLICKEYBYTES * 2 + 1];
    unsigned char secret_key_buffer[PQCLEAN_MCELIECE348864_CLEAN_CRYPTO_SECRETKEYBYTES * 2 + 1];

    GetHexadecimal(public_key,public_key_buffer,PQCLEAN_MCELIECE348864_CLEAN_CRYPTO_PUBLICKEYBYTES);
    GetHexadecimal(secret_key,secret_key_buffer,PQCLEAN_MCELIECE348864_CLEAN_CRYPTO_SECRETKEYBYTES);

    const char* secret_key_good = "1E676D1BD2AC9A8407C0E1B06BD742EA37ACA869C6BC51FF23B426C4B95FC1A24FCA61811CF733C3626C425031E91FFA02673E9CB31B5F6BBFA424F9E65C7B01772A1AF26C44521297BF94AA42E899DC68B74238147A8351BB7ACE97AE3E32100F7892B8F871C1370FEEFCA8D96C6C986DC942306CD739676F661359482D21ABDA36F23CA8DF4B108B2C6AAFC1BBE992F97DFCB2235E2A2E368960BF5A86DE9C0597117296AE9DD271915F22F84594B587AEBBF2F48C94E432C5F32CBDFA20E4E0E665964826134D37C9DDF9A974FD735F81A9AA9817E526131ECDED2B70EA4B9C09CD56D0C751FCF0E59CBC2D9F4F9EC46274C1DAA4067BABC03EAF5976D13FA1AC0C3A04B8B0568D6601A9FA7967F1BB25F4311CF44F1E08E1688EF4B25206F5025F829DE3B9D0772B32181B511A5AB14644729F362BF3FD7C9B3CA1EE896BCBD0AC6835D56FACFA406531654DA3E2B96812E5C103A8978816CE04BD02087ED0C344A98E2E9D090EE928E906DD3CEF6BBF31A03C548D0AB236CB91F13F7B6641146C5A8D141F92909E93A3CEB07A8C7C803C05ACD248C63B0F20410229FCFA0054B7FAE135C902CBD614395AF7BF8DFED01E50520DDA07A706A205950F1B057104830E340DC9018A007B03A10CB10B3103070BBB0EA402EC0D47056F010E085F0BBD0C6D073F0AAE00350EB307CF02F00D6C0AA308CC008D04080B25093D0A9A09970A9705930A9101050778027302110873083003900B7804C10D6302D004C90DCA06A8018C02B50A3B0AE108F20E7C0B820EB2A7A23847CD95ED2581718FB8E04C46BCF06B6B4951D02BA4A0C6840BA2688048D647E8416CEFD8AF4F873A917A1A24656A4C1C25A2F51827CB2E09A92876CBF7A91D0E54739F0A68B3EC96ECA59DA08D8FE354226755D01A61D7383268A29D015842BCBA798E2836DD3CDE9036728B46C0C1402AE66736DBF7D47EBC8C40E3AF7512D32AEACBE3726A174AFA003EBBE04099F5B17E1F8D4B9488F81838AEDD62B688A0290AF83214D8809205C9724DAAAC82A0E16D982CCA97F5ED02D1C77688456A399C8AF3B849500E011DB452AB56E67137EAA6018A0ED9126023894C5C5F83B3128911B46122906D566DCC6ADEFAEF1B28DDC7283C3F6BD4C2066777E080382F42BC54B0A817BC2240EC27EEB7A9E6AED62BDEB4543C40F06DA5066D0A8ABEDED4C9E5B02774EFA94A47DB003EE0B2B11944CAF573B28F7DF151CC14CC7440714C9C6C6F88681001ABB83D3255BF8959ED9373C0E95C8974FBC3B315A76DDC7D6330537A4C99BD0E0D821565B7B85E288318832FBAEDF4C62106B367A8D5445FD7A70ABF41F459EC09CEEB2D8B5AFEA50EA87E12CF9B7AC8434A4504A66F7A8F49582BE828ED5E125C7B30CA65956FA4B18857E4A6D7CA0543F261BE71DD74CFB4B21154DC4E912FEAB086EBECF6E386D9E603FE7F8FEC818A7E0C6D279527E04ACAF9D9F3501B51FC07CB855AEA34853AB5DD035A2B2132FD7350E3968029E9C71AA339C04344D4EDCD5B537AF5591CE148B828CE3569DE3AB64A6A8A71418F2647601F82E80EB7978D9F844CFC80AE586D5073E03C9F026E623F1CFF68BE84426B95802946B39531444273CE96109DEB279B03B1656D9049FDA5F796DF583DA6F982A3955B92AF13566172C47E1837E37816CC6057D555CE92F3BF61300910286FD181BB42FC3D14AB344EA83F45C8F9D6F67A7C1A6C448D78302E04C447AA84B1AF9A762BB45E87FA92994A8B23D068757F740D5D222ED231D35E2B60BA0A869663E11A2DC0893374B91A80B8C176A8D235AB48299E60824A593FE547FAA29F036F4A7DB0BA39C2E5C47AA00BC8A4BBCFEACA1A6BEE0186BA8865A0001A916BBF80F5A262BEF348CDE5F4F9EEDD056A4A181DC52F087351CFE398A4AB42A912497410E8092148A032E043127FCEF45AAEDB174BF14D03B1812F5DAFAF46494C0552E0F00A8F640739719E6DDD833D69FF83092CAE58B48AA8BCBDEED5379CA91D35BCBABCAADBE4E0C97282307564B7F546A7AF6A7E5EE95FA0685746A76BC2D53ED4450FB3E8D37282962F9F4FED716CED170F07C4AF37C9E92A1613FDAE24F75FB71DE7EEF368A01DBA10DA5B98F7AE3A4DE77DCBC4B65D343EEA3C7D67E5359ED501E1D41D89AD1CF4514D5254765E9163FE5A377DE1E79E8D2027A6FC974B2BB4EEE53DF69CC7C033C5C79783AE629A318CC94693D54B8BECA50000C049809DDEE9F7CF118EDA93DC1559AAE2FF7A1CAD6E3771355D6FE8006D933B53301FC826F2B172DA7EB1D72B1CD5BA1EB51AA0045766F8699B2F051AABEB50184B66E74D496799FD6A037BAD3B17B00915D1A7983843A2B8A3DE69245BD4FC39575F189ECF9F51A82E67B7F302FC4477D50DB9F2830133BB2A17D1751C7527D7DCEBAC01F137685A4438783EA40386DBE40E31E7F46F71E4F83EAF5F9CB59EC98848DB4AB028E74E504F9238A3B551400A8BF8C0E8F7BDE2EDDD8442586D28FE8EAB86186530967DB2BF18BDBBFB810766E926A7483012597AD5B295DB0A5D88BFB6CFC4D59D41ED74F44279244C1610E8DAE5F4293179AA1B617F33B900000000F06FE3D083C98ED40AD18E46D3700AF57B51D3B79A4125A626F4071C009A006EB7F432651AAB4379152664C71F5B71B40C5911D1E2F40A4D484D213541A9054A2905E1117FCD140DD776FCB3B50473029E5C3BEE57271BCF2B7ED950D53CFE01A22FF35C6A7D209C8FDB3B288526E8179F003968BB340F1A3F907A94536E5E65B2628213BBBBC69EEE9878E6C16F05F431B73D93E898CCF2DCB3C75B5A7559D480CF592232DE9DE44F7CB5F8032CEFE9DB1C48E5048252ADD0FE113637D549C0709C126D1C2BFD35C3F28B96EF059128AFDFF9584FED1AA1C1A85C1C7F0E6C5C7F21868AA56535358D1D0B45E5D4F5CEAFFB9376DAB9C60D75541ADE0000000000000000551081F0276C602091A7CCF15CC22B1B36C648C5B588BDE45601CD4A765F5D0DC13C6D81703DF1F575B07C6633032817D55CA2308DA77C5788A08F710A84E56B19C99211ACCB48A8DA58B5B805B7F44FCE95AE99C1BF076555AA7F9830C96ECF0764BD6F82BEABD8CF5AEC25336EA73A4886FB105ABBAFD2ABD44D03E8DF9A8DD1DC3B215C8028C9E489A78121B569E2AE9B18E35E0D7E52064AA5CE5AB28EE397533331F1E346146BEE1F2BCBE575BD5B2F6436EF8249D840533F8A123A1592E303D920F26669D182EB279C6D962686866CE4AC8B28F688A3BE20E032388056FAF269F506D8A45ECD1F984C7A593317644740A9F42E84D400000000000000000000000000000000195113C099609407788523428B9E820F2F88BC4DD68EA47B6D504C779E682A6AC8835F3565985C3CC465ABF80386D307A89921DFF7134F91D26D7184993C6745A8B350CC5EA39B36A0E6F7EBC34068A62146B3176CA5EDC593D673E75A77B024672E94CB2A38DDA94D097E2CD8AFDAB1687B903195C0BC5DCCC145991CAFA5DE0D994A82DA97B27BA895D8564A528D38F02B1471AD61649ADFB35392A50F8D8B1D8D198550291FF6B6330526A887956B04396F2D39B71F2880C54269FDBA74AC8ECCB2777756291EBC08E8398AABBDC32DAFEB9E2E6C4123CCAA7CC350346DBF614124EE7444ED03F06A2362002109060000000000000000000000000000000000000000000000000000000000000000A008287828070886555FFCFB3748C0E414427933E0798101CEC400DDA30070602867145F849CF05769D5C623143233A05BBCA2814375A2DD92A21054C5A2C83DBFADBD86A40C1180C5FC1A3651E0FCFD0989B1AB317C44F46D2E98E403CFA1C98D8358E3997C12BA1CB6DB953B182590E1FE1E8E90ECF1D07A805B693126F62D320988A8E53F4FFC18578192BA970F1D8A6F196FA5B6B0D0E4D55C5147423C9796F7DFD2CA31218AE1E9991240C66F05B12F5A76F31EBD6B3E0D00609B2422A179CD9E74C4DA0AAFA6B9C096F4CC6CF72F844CCC99CD73F0EFDEA9B7AF0EBCB300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A88D40B093353465C5082CEB78220A591D989ABB20D09C7E0A6BB5C2C0DCA1901D0B92405103C988411CC79A51E062024EC1A2F0011382C0E1D6C594D63C8C5C8A3ACA3D020890F07890FC2918F18D60FFDEF783C6160EF9D1F18C3C3B676BF226560DE36CCD78D10017826BC342FF4B53547EEB4B810CA7A614632C248510B17705BE7AB25E55F9A54DDA11AB176030143099F242D21FFD15B80B685E27DF1B785931E0EC84AFB43BE044BFD5184B384404937C3ECD9200202A2EF8D3F0CAA100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003D27442E3429B55CADD10053E5730B3F3C49F80076C5A58445105A3792480A93556E125A04212C12A247C18C15C24D24696057D2F8A09400500201B30F56B669A43511A213E219200CD0A2B21B24891230D2A903F01AA0DB70A850ED73022C6511384906AA4089E8107B22840C7D292FD5BC6C4A4BCBD1B1731AB901592CF6F97F3F4C721D0CA6FEA8AD037C20A8B95BB2A30F7C82D08914CA441E84FFCFD57394A7B5E13D8FE1D34AC7C50717051F6A447F7A5DEAE5C20C1D0876976D78A81C09D2A973E6739D6A8C619C86060C1492CDE4C623A49FB24AE4AD1072F621DC05E50A13C6EE208BAE120A20CDEAE8C2C640D1658A7D7313D3E382BD19DEAC36DD6E05E31D20B5D1D955F2DE83E5575A240F5CF0BAF727F4879593C23B51270AB2695802DFD0A27E54B828E9A9A9C3402EB94F85E7F2267DC0780A0132FFB7D765E57511EE118446341296A3343DA7AFC3BA572D0F5DF227F13F9479FD4113A2625273F86D85EE21630BFD36177457B96DFFBC4D4556B9D262983C25AE1981C92880D801699C031F024F5A606F5569E03B1939D280310C48292A8494F186B0EC8436873F120838828673132232A66C184046307030045BB3832344496C008C4C4904034A8906BE610FC2710E299A329B0117813B940A24842C036A65843BCC7919B8F16181489BC40DA4245F20110422989C2D8A0E03000D9508F1D212A44191B4FCCF18A92A672B1468BCA01C7EE0090C26CFADF5065BDB490D0E79B735D873BD6E044990B3D9D06943471C99C5AF04684B231D7418BEB9CE7D1C866D204DE5DE81783657EE3282C03367E3E05AE672D89F3E2A1B860C046C40DBB97EEBEFE0D1598FF2E8005BCBF528CD5628A866A630801C780DC6DEF292BC3B31CD3ACC57C43A60B4C0CA341051010559742BC2648857CF005211582E871906A22E981A03480251A809F04115F94B9984D880A4ACA54BA1C2C7119C81EA86B7286C32D09CBB1CC957ABD0E9A314251D5DC095F9CCEED9108CE50AB44E47643ADA98A02C8609E97007AFA42507A5A0C58EF6426D531082A170848D22C1056E5F2048E0E66718EBA10D2AA53352667CD6476C0C7C36AD956BE6CF8F332066AA86285C9F0593CFB50710C9B22B031CD7C989008E312345E6BD79FD395C65876351BBA7053C6CD17C0228B9FB03DAF913649E26EE44C3EBC7E5ACCFA499D99D1B7E5CD7BFB48B0E012C19F5E368EFDB845B8288842042B839C2B1F85AE41C8C101AD6395DC75D575D5400411629F0041E13C08489971120A91D08B188A65954104C331494211AE9F0CCAAB64DA7F6A053765BD403C409346D719BBB290747DC81B27A59914623544C545B021A9AE8BF481B333152343CB6D98A1FA704E49A17FB198BB031C93AC35E855499D5DA997278B594010AA26594AD9EA2690DD3587F5604060E253CB2235BB92038102F6CE43CE1740DC9F6E612DAB9DA51A32964AFDFDCB41273E2E378ED32065141A4C6036261F7F05EA9F9F3F48B0D9F5A05887C0EECD818FB1034C900202A5A2368F11844E59BC0928B24E301A6B0703F2483AD9162062199C0ADE32FAB19CB765A736A2C53485B337076ED2953613C1EE94BE638B2DC06804C30ACD0597E0E28DE49B60090268B129048808C33D38792505AA4B5F039AC0B502D5F0D7F78016312B346EB3A81744420A8F91418256D533DB8ED4B7E706B2489FDCE2264F9BB8B12DCD967C61C22926511B703D99C66E1A6E6D9955142B27602314D286D6A17565AAB4F449B456E9751462062A85F964046E818079F0289ADEB0B96C89BF04D9A1C00A55DCE6BF7DC0F2B269140C421D49446B080A0288D9D183D912843C24DE20583C501419DEA9940D71E47DB806D027EBECE3D70FAFCD9369D7F6A0C4232184BE535DC43C8A3B08ADC7366CED1C993A53376D09B631F6B932F9D2040A6424E23FD7BE2CB9A5C5B21010F299095A18770FB36886F77938478F82C259ACAA260409A06302F7A72CAE68168437AE754B300DD3D79E5A66D2D9088F964F0798528051C2E1FB52EAA0CE149AC0601B0653C148700F59D7A04F2ED73A1C39E9F83D898B3DB05FFC8B66A1FB0F167E9825882AA1F9391FB9FAFD40D69DA92B1295114E2783705232CADAF4DFF45C6414C2843216E116720C507A97A79B86CCE1B9063585155C3C02F4C3031E6905361440D12088777A18F7ED45134CF1B486E8CAD973B2A45F58E15908F7B3DE2F838A5F9C797F517DD67CCC6BE9256397B44772227D75488C1BB2509E25551AF1E79C3E646904A725883F63CC426F80040CD36CEDD6ACC06E800355E1C3B9661EA6384FB70B6CDB1B4EE312E6DA5CF5AC00632542752F4CA080595F4CD83B9D096C42DDE61AE0D059AD2E88E7E5EB6ED43198762EFE88C4200998B11C918B2E242F807BDDA66EE9569A55EB154488F87BAD16EB687938B28B8FCBFA91B016539BF89041258DDEE4BA9A3591BF3010D5F8F7D399C7BC493FD8A469855A32AB9DC508B6BC619DE87D613D19839F784E61C7A696F0F4B7166629B83027F0A59603711F044A7C70C5849E5118BB4CA99F8502C38E5A813F68F7BE60CB301B861616AE55D3F0410CE539EAD119771161AF7FE7966E77908C6C171A4399BE8D4F8EAD155672850F86E3C372A91D72778922A2BC61D3AF9626851F550A1D91FB52F56B2F0D31A080B911F5491EC065A50C15EAD000908B00E058031360AA5362AB3914A836242CE493BE8FEFCD0180B2261614FFF6365A8856B6BC02C4DD257D6B35F1A239B35A49406CEC2A76476520FCD6864B49790C68A55E269D2CA6C193D6539F2B24C3273F9B6CD0C8CF389C9B8F48B13342CCF4005F6FCDE6D1EFF326019EE7EE03B970A4BDAA50290C3E70A5C32A7DC8C9A4B7B72A3372C1B24A3072779B77DFAA6BE399E27F2716E7FFFD60272BC68647113A2ABB481722AEBAFB8273C8A3B3F6BE9ACBE759441C9118133E2EE5F4B62E58CA903F7096393A20EECA0CFBB9B70C473E07F253478EA9AE9FAB287C7C087F0AA872BCF19713B48988B620E2B45D8B1FDB4F7EB313BD7CE565A031B165724612752598CEF15FE10F8B75A6D0D8352C00A75731395ABE79624C4A81114B0BFBA874123A1A1CA86C77E9B1826FFFF8F2E93D8688C1126C0FBFE497910381EF0428259BA1ED45E7DDA3701913C8BC7A41F82C601A2F4188FD29A86E487B2E60C02CD4033516FDBD1DBE50DBCC0D976AE33CA1BC2AAD305777FC2D36A57144ED6E52DAB6166D733C74CF3F48D3D6290235537F4EDCAE3BE63E47162507B669C939618EC2B200D73C8AEB863D6E127F68713644A7EFDA96DBAAAE10D913A24B4E1978846ECD5F04AB011F3A0DB6770421871DF9ADA3B211736FFD0EEF82C3A0EDA86AAA22849D86F8E204D70BAF5004FF39A1AB6D50E741A1A801E5057DAC42682E6BBD5C617EA373AC22684F446A08C2C8A1C39F4B560B673272134EDD36D32997409571FB1C800E2288B5BA1228C516B62B00C47ED7AACAAA5CD7044D391177F8CFDE40F5E3CDDEF2FF1381753133FE422B4A51FA68B3128CF197CE1F384F4669B4722A7BD8976E08352529D776D77F8CF43B3E7B999B4E16DD4DEF7585251A8E7BD3C64651016496F348FF7A65A108FCC0F58B4A1F0EF0D478673C49B52844C5C566EAE6B841CF5BD3AC805CA174FEF72901ADEB62B2A7B40E1BD2D8229B59C1458C17A9C9187280AAAC42E84B2B71B5C5298C5B61D33517F119BBB4DE4C0FD98EF7B5F91ABB5D72E4D43C3248D9824CBA82D8526CF0F1755D63F51C3B99540A24289147413ACA5C7B63F41C007A8558B3C6F816155AAB45BCD6B668C3A5BC8F2BAC7AD57EDA3077EEA51FC6C824EA65EFDE0A34BA2E427C9046CD041418E74933CC257BBD4CFB604924A5B7B2F42357A60A89746F9A918C3D5D602904C982B83A6CE8B39174E7E048B18FE4526EE40A4D6FB6F59849885E1328C7382F2747345C1728A2F0A27D8258A53E0B8BC6A8B0105423478F78BFDFD8A61B92CDAD79F88FD33745A413E55F63E9C1E2B5A5B2FFF840537F2B0783E4E5A8CD2A6DC8B725A86E00BD90D118C0CA0946624CCC16EDAE6CA60D3D477F41F048EB3F707CF4C55612F3FE8DD57F86197570CDCB15E65AFEFD6244102CC91313E30FF4CDE20AC10ED833E7B379B5B754450D02D63BA4EB6DEE81DE5D2FEBF3EE976C28767E83F3CF477194F050C9F0674A5EDEDEB6C7B8BA8EE83300735B0FE0725C73D94A21BDB7BA5443C423E2708324ED33D9A1D5AE67954CCEC18CD6D7BB6E4BA3D29C2636CF2432817DD1BA035B18B3CD7DE6E9047EDB4FB1C116989EB8624CD7CD70173C14AE6E66E2407232D3FB78836B65431ADF21433F32894BD6E85893C42B853117F06D5CC518F5597B40EA6B618816D42C0AD9E62651201F9D45CF575F992FF8DE32542CAF6DD603367C9D65D6AE0C6FA2E979DDDB9569CA6C2A5D07B57C8C5A1558F7101E0711345B7845926C78C563A8CB90FE2B159573A7D482849358E1B";
     
    //public_key_buffer[100] = '\0';
    //secret_key_buffer[100] = '\0';

    //printf("%s\n",public_key_buffer);
    //printf("%s\n","0707214775B5EB3E7CCE7AF7804A06146FB1F74DCD6FAA9635128E317A6870E8F5385434299BB88884959DE74D8E46DBE5EE\n");
    printf("%s\n",secret_key_buffer);
    printf("%s\n","1E676D1BD2AC9A8407C0E1B06BD742EA37ACA869C6BC51FF23B426C4B95FC1A24FCA61811CF733C3626C425031E91FFA0267\n");

    for(int i = 0; i < PQCLEAN_MCELIECE348864_CLEAN_CRYPTO_SECRETKEYBYTES * 2; i++){
      if(secret_key_buffer[i] != secret_key_good[i]){
        printf("Different: %d\n",i);
        goto label;
      }
    }

    printf("Equal\n");
     
   label:
   }

   int result = 1;

   if(result){
      uart_sendfile("test.log", 12, fail_string);
   } else {
      uart_sendfile("test.log", 12, pass_string);
   }

   printf("Gonna call uart finish\n");
   uart_finish();

   return 0;
}
